---
title: Clase - Caldera Framework & Procmon/Sysmon
date: 2024-11-14 00:20:00 -0500
categories: [Cybersecurity,Ethical]
tags: [Hacking,Pentesting,Exploitation Techniques]     # TAG names should always be lowercase
---

<!-- <hr style="border: none; height: 10px; background-color: #003b00;" />

# <font color="#87CEEB">Examen Parcial.</font>

<hr style="border: none; height: 10px; background-color: #003b00;" /> -->

## GENERACION DE ATAQUE DE DATOS 
La generación de datos de ataque se lleva a cabo mediante el uso de la herramienta de emulación de adversarios CALDERA. Los datos generados están relacionados con el comportamiento típico posterior a la vulneración, ya que un host del entorno ya está infectado al comienzo de la emulación.

## Agente CALDERA
CALDERA se comunica con el servidor a través de un contacto HTTP específico. El agente se comunica con el
servidor en función de la dirección IP de alojamiento del servidor y del puerto 8888.

![f7](/assets/imagen/f7.png)

**Implementación del agente a través de la interfaz CALDERA*

El agente se crea a través de la interfaz de CALDERA, donde el usuario puede
especificar qué sistema operativo está ejecutando el objetivo del ataque. CALDERA
creará y compilará dinámicamente el agente en función de la información
suministrada. Para instalar el agente en el host de destino, se ejecuta manualmente
el siguiente código de CALDERA a través de PowerShell en la máquina de destino:

```bash
servidor = " http : // 1 9 2 . 1 6 8 . 5 6 . 1 0 5 : 8 8 8 8 " ;
```
Una vez ejecutado el código, el agente CALDERA se obtiene del servidor
CALDERA y se muestra en la pestaña de agentes de la interfaz.

![f71](/assets/imagen/f71.png)

En Resumen CALDERA : 
1. **Emulación de adversarios:** Permite a los equipos crear perfiles de amenazas específicas y lanzarlas en una red para identificar vulnerabilidades y probar defensas.

2. **Pruebas y evaluación de defensas:** Facilita la prueba automática de defensas de red y host, sistemas de registro y alerta, y respuestas automáticas.

3. **Engagement manual de red team:** Ayuda a los equipos rojos a realizar evaluaciones manuales con la ayuda de herramientas automatizadas.

4..**Investigación en ciberdefensa:** Apoya investigaciones en ciberdefensa, simulación de amenazas, operaciones cibernéticas ofensivas y defensivas, y análisis de defensa cibernética


using System;
using System.Drawing;
using System.Windows.Forms;

public class FlowchartForm : Form
{
    public FlowchartForm()
    {
        this.Text = "Diagrama de Flujo";
        this.Size = new Size(800, 600);
        this.Paint += new PaintEventHandler(DrawFlowchart);
    }

    private void DrawFlowchart(object sender, PaintEventArgs e)
    {
        Graphics g = e.Graphics;
        Pen pen = new Pen(Color.Black, 2);
        Font font = new Font("Arial", 12);
        Brush brush = Brushes.Black;

        // Dibujar elementos del diagrama de flujo
        g.DrawRectangle(pen, 300, 50, 200, 50); // Inicio
        g.DrawString("Inicio", font, brush, 350, 65);

        g.DrawLine(pen, 400, 100, 400, 150); // Línea hacia abajo

        g.DrawRectangle(pen, 300, 150, 200, 50); // Seleccionar Perfil
        g.DrawString("Seleccionar Perfil", font, brush, 315, 165);

        g.DrawLine(pen, 400, 200, 400, 250); // Línea hacia abajo

        g.DrawRectangle(pen, 300, 250, 200, 50); // Configurar Escenario
        g.DrawString("Configurar Escenario", font, brush, 310, 265);

        g.DrawLine(pen, 400, 300, 400, 350); // Línea hacia abajo

        g.DrawRectangle(pen, 300, 350, 200, 50); // Desplegar Agentes
        g.DrawString("Desplegar Agentes", font, brush, 325, 365);

        g.DrawLine(pen, 400, 400, 400, 450); // Línea hacia abajo

        g.DrawRectangle(pen, 300, 450, 200, 50); // Ejecutar Emulación
        g.DrawString("Ejecutar Emulación", font, brush, 320, 465);

        g.DrawLine(pen, 400, 500, 400, 550); // Línea hacia abajo

        g.DrawRectangle(pen, 300, 550, 200, 50); // Fin
        g.DrawString("Fin", font, brush, 370, 565);
    }

    public static void Main()
    {
        Application.Run(new FlowchartForm());
    }
}


## Instalando Caldera en el Kali Linux

### Paso 1: Crear un Entorno Virtual**
Primero, necesitas crear un entorno virtual para evitar conflictos con otras versiones de Python y el framework. Abre una terminal y ejecuta los siguientes comandos:

```bash
sudo apt update 
sudo apt install 
python3-venv python3 -m venv caldera-env 
source caldera-env/bin/activate 
```
![f72](/assets/imagen/f72.png)

![f73](/assets/imagen/f73.png)

### Paso 2: Instalar Caldera
Con el entorno virtual activado, ahora puedes instalar Caldera. Ejecuta los siguientes comandos:

```bash
git clone https://github.com/mitre/caldera.git 
cd caldera
pip install -r requirements.txt
```
### Paso 3: Instalar el Plugin EMU
Una vez que Caldera esté instalado, puedes instalar el plugin EMU:

```bash
pip install caldera-emu
```
### Paso 4: Configurar y Ejecutar Caldera
Después de instalar Caldera y el plugin EMU, puedes configurar y ejecutar Caldera siguiendo las instrucciones en su documentación oficial.


### Actualización del Kali y preliminares
Actualizar Repositorios y Hacer Upgrade
Es una buena práctica mantener tu sistema Kali Linux actualizado para tener las últimas versiones de paquetes y parches de seguridad. Para ello, puedes usar los siguientes comandos en la terminal:


```bash
┌──(user㉿kali)-[~]
└─$ sudo apt update && sudo apt upgrade -y
```
**sudo apt update:* Actualiza la lista de paquetes disponibles desde los repositorios configurados.

**sudo apt upgrade -y:* Actualiza los paquetes instalados a sus versiones más recientes disponibles.

Estos comandos garantizan que tu sistema esté al día con las últimas actualizaciones.

### Crear una Carpeta Caldera

Para organizar mejor los archivos relacionados con Caldera, puedes crear una carpeta específica. Utiliza el siguiente comando en la terminal:

```bash
┌──(user㉿kali)-[~]
└─$ mkdir ~/Caldera
```
**mkdir ~/Caldera:* Crea una carpeta llamada Caldera en tu directorio principal (~).

Esto es útil para mantener todos los archivos y configuraciones de Caldera en un solo lugar, facilitando la gestión y el acceso.

Estos pasos son fundamentales para preparar tu entorno antes de instalar Caldera y asegurarte de que todo funcione sin problemas.



### Crear un Entorno Virtual de Python
Primero, cambiamos al directorio Caldera que creamos anteriormente:

```bash
┌──(user㉿kali)-[~]
└─$ cd ~/Caldera
└─$ python -m venv caldera-env
```
Para activar el entorno virtual, ejecutamos:

```bash
┌──(user㉿kali)-[~/Caldera]
└─$ source caldera-env/bin/activat   
┌──(caldera-env)─(user㉿kali)-[~/Caldera]
```
Al activar el entorno virtual, verás que el prompt de tu terminal cambia para indicar que estás dentro del entorno caldera-env:
```bash
┌──(caldera-env)─(user㉿kali)-[~/Caldera]
```
Una vez que el entorno virtual esté activo, puedes proceder a instalar Caldera y sus dependencias sin afectar otros proyectos de Python en tu sistema. Esto es crucial para mantener un desarrollo organizado y evitar problemas de compatibilidad.

